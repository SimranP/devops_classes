---
- hosts: webserver1,webserver2 
  tasks:
    - name: Add yum repository for nodejs
      become: yes
      yum_repository:
        name: nodejs
        description: nodejs
        baseurl: https://rpm.nodesource.com/pub_7.x/el/6/x86_64/
        gpgcheck: no
        enabled: yes

 
- hosts: webserver1 
  tasks:
    - name: "Install nginx and nodejs"
      become: yes
      yum: name={{item}}
      with_items:
        - nginx
        - nodejs-7.2.0

    - name: "Modified Nginx configuration"
      become: yes
      copy: 
        src: /Users/simranpal/workspace/devops_classes/app1/default.conf
        dest: /etc/nginx/conf.d/default.conf

    - name: "Start Nginx"  
      become: yes
      service:
        name: nginx
        state: started
        enabled: yes

- hosts: webserver2
  tasks:
    - name: "Install nodejs"
      become: yes
      yum: name={{item}}
      with_items:
        - nodejs-7.3.0
